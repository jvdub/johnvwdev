/* Utility to remove underline, overriding global a styles */
.no-underline {
  text-decoration: none !important;
}
@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --brand-navy: #081a33;
  --brand-gold: #caa64a;
  --brand-forest: #0f2a1d;

  --bg: var(--brand-navy);
  --bg2: #061327;
  --surface: #0b2242;
  --surface2: #0a1d39;
  --text: #eef2f8;
  --muted: #b9c4d6;
  --border: rgba(255, 255, 255, 0.14);
  --shadow: 0 18px 40px rgba(0, 0, 0, 0.35);
  --accent: var(--brand-gold);
  --accent2: #e1c36e;
  --success: #3aa87a;
  --focus: rgba(202, 166, 74, 0.55);

  --radius-lg: 18px;
  --radius-md: 14px;
  --max: 1040px;

  --font-sans:
    ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial,
    "Apple Color Emoji", "Segoe UI Emoji";
  --font-mono:
    ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono",
    "Courier New", monospace;

  /* Scrollbars (theme-aware). */
  --scrollbar-size: 12px;
  /* Default (dark) uses brand gold. */
  --scrollbar-track: rgba(202, 166, 74, 0.12);
  --scrollbar-thumb: rgba(202, 166, 74, 0.42);
  --scrollbar-thumb-hover: rgba(202, 166, 74, 0.62);
}

:root[data-theme="light"] {
  --bg: #f7fafc;
  --bg2: #eef3f9;
  --surface: #ffffff;
  --surface2: #f6f8fb;
  --text: #0b1220;
  --muted: #475569;
  --border: rgba(2, 6, 23, 0.12);
  --shadow: 0 16px 34px rgba(2, 6, 23, 0.12);
  --focus: rgba(15, 42, 29, 0.35);

  /* Light theme uses brand forest (subtle, less contrasty than pure black). */
  --scrollbar-track: rgba(15, 42, 29, 0.16);
  --scrollbar-thumb: rgba(15, 42, 29, 0.52);
  --scrollbar-thumb-hover: rgba(15, 42, 29, 0.72);
}

:root[data-theme="dark"] {
  --bg: var(--brand-navy);
  --bg2: #061327;
  --surface: #0b2242;
  --surface2: #0a1d39;
  --text: #eef2f8;
  --muted: #b9c4d6;
  --border: rgba(255, 255, 255, 0.14);
  --shadow: 0 18px 40px rgba(0, 0, 0, 0.35);
  --accent: var(--brand-gold);
  --accent2: #e1c36e;
  --success: #3aa87a;
  --focus: rgba(202, 166, 74, 0.55);
}

html,
body {
  height: 100%;
}

html {
  /* Avoid layout shift when scrollbars appear/disappear. */
  scrollbar-gutter: stable;
}

/* Scrollbar styling: Firefox supports width + colors; Chromium/WebKit supports full pseudo-elements. */
* {
  scrollbar-width: thin;
  scrollbar-color: var(--scrollbar-thumb) var(--scrollbar-track);
}

*::-webkit-scrollbar {
  width: var(--scrollbar-size);
  height: var(--scrollbar-size);
}

*::-webkit-scrollbar-track {
  background: var(--scrollbar-track);
}

*::-webkit-scrollbar-thumb {
  background-color: var(--scrollbar-thumb);
  border-radius: 999px;
  /* Creates a little padding between thumb and track, without shrinking hit target too much. */
  border: 3px solid var(--scrollbar-track);
}

*::-webkit-scrollbar-thumb:hover {
  background-color: var(--scrollbar-thumb-hover);
}

body {
  @apply bg-bg text-fg font-sans antialiased leading-relaxed;
}

@layer base {
  a {
    @apply text-accent underline underline-offset-4;
  }

  a:hover {
    @apply text-accent-2;
  }

  h1 {
    @apply text-3xl font-extrabold tracking-tight leading-tight sm:text-4xl;
  }

  h2 {
    @apply text-2xl font-bold tracking-tight leading-tight sm:text-3xl;
  }

  h3 {
    @apply text-xl font-semibold tracking-tight leading-tight sm:text-2xl;
  }

  /* Prevent horizontal scrolling from long URLs/strings. */
  p,
  li,
  a {
    overflow-wrap: anywhere;
    word-break: break-word;
  }

  img,
  video,
  svg,
  canvas {
    max-width: 100%;
    height: auto;
  }

  pre {
    @apply max-w-full overflow-x-auto rounded-md border border-border bg-surface-2 p-4 text-sm leading-6;
  }

  code,
  pre {
    font-family: var(--font-mono);
  }
}

@layer components {
  /* Only apply list markers/indentation to long-form content (e.g., MDX posts). */
  .mdx-content ul {
    @apply list-disc pl-6;
  }

  .mdx-content ol {
    @apply list-decimal pl-6;
  }

  .mdx-content blockquote {
    @apply rounded-md border border-border bg-surface-2 px-4 py-3 text-fg-muted;
    border-left-width: 4px;
    border-left-color: var(--accent);
  }

  .mdx-content blockquote p {
    @apply m-0;
    white-space: pre-line;
  }

  .mdx-image-figure {
    @apply my-6;
  }

  .mdx-image-align-left {
    margin-right: auto;
  }

  .mdx-image-align-center {
    margin-left: auto;
    margin-right: auto;
  }

  .mdx-image-align-right {
    margin-left: auto;
  }

  .mdx-image-frame {
    @apply relative overflow-hidden rounded-lg border border-border bg-surface-2 shadow-elev;
  }

  .mdx-image {
    @apply block h-auto w-full;
    opacity: 0;
    transition: opacity 220ms ease;
  }

  .mdx-image-frame[data-loaded="true"] .mdx-image {
    opacity: 1;
  }

  .mdx-image-button {
    @apply block w-full;
    background: none;
    border: none;
    padding: 0;
    cursor: zoom-in;
  }

  .mdx-image-skeleton {
    position: absolute;
    inset: 0;
    background: linear-gradient(
      110deg,
      rgba(255, 255, 255, 0.04) 8%,
      rgba(255, 255, 255, 0.16) 18%,
      rgba(255, 255, 255, 0.04) 33%
    );
    background-size: 200% 100%;
    animation: mdx-shimmer 1.6s linear infinite;
    opacity: 1;
    transition: opacity 200ms ease;
  }

  :root[data-theme="light"] .mdx-image-skeleton {
    background: linear-gradient(
      110deg,
      rgba(2, 6, 23, 0.06) 8%,
      rgba(2, 6, 23, 0.14) 18%,
      rgba(2, 6, 23, 0.06) 33%
    );
  }

  .mdx-image-frame[data-loaded="true"] .mdx-image-skeleton {
    opacity: 0;
    pointer-events: none;
  }

  .mdx-image-caption {
    @apply mt-2 text-sm text-fg-muted;
  }

  .mdx-gallery {
    display: grid;
    gap: 1.25rem;
  }

  .mdx-gallery .mdx-image-figure {
    margin: 0;
  }

  .mdx-gallery-grid {
    grid-template-columns: repeat(1, minmax(0, 1fr));
  }

  .mdx-gallery-cols-2 {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }

  .mdx-gallery-cols-3 {
    grid-template-columns: repeat(3, minmax(0, 1fr));
  }

  .mdx-gallery-cols-4 {
    grid-template-columns: repeat(4, minmax(0, 1fr));
  }

  @media (max-width: 768px) {
    .mdx-gallery-cols-2,
    .mdx-gallery-cols-3,
    .mdx-gallery-cols-4 {
      grid-template-columns: repeat(1, minmax(0, 1fr));
    }
  }

  .mdx-gallery-carousel {
    display: grid;
    grid-auto-flow: column;
    grid-auto-columns: minmax(70%, 1fr);
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    padding-bottom: 0.75rem;
  }

  .mdx-gallery-carousel .mdx-image-figure {
    scroll-snap-align: start;
  }

  .mdx-zoom-overlay {
    position: fixed;
    inset: 0;
    background: rgba(4, 9, 18, 0.85);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 1.5rem;
    z-index: 50;
  }

  .mdx-zoom-content {
    position: relative;
    max-width: min(96vw, 1200px);
    max-height: 92vh;
    width: 100%;
  }

  .mdx-zoom-image {
    @apply w-full rounded-lg border border-border bg-surface shadow-elev;
    max-height: 80vh;
    object-fit: contain;
  }

  .mdx-zoom-caption {
    @apply mt-3 text-center text-sm text-fg-muted;
  }

  .mdx-zoom-close {
    position: absolute;
    top: -0.5rem;
    right: 0;
    @apply rounded-md border border-border bg-surface px-3 py-1 text-sm text-fg shadow-elev;
  }
}

@keyframes mdx-shimmer {
  0% {
    background-position: 200% 0;
  }
  100% {
    background-position: -200% 0;
  }
}

/* Theme toggle label: derive text from the current theme attribute. */
[data-theme-value]::after {
  content: "dark";
}

:root[data-theme="light"] [data-theme-value]::after {
  content: "light";
}
